#!/usr/bin/env python3
import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from bot.utils.extractor import extract_amount, extract_company_name, extract_all_receipts

# Тестовый текст из вашего документа
test_text = '''Акт-отчет № БП-22102
о исполнении Поручения № 1 от 17 июня 2025 г. по договору присоединения, акцепт № 3912 от 30 мая 2025 г.
23 июня 2025 г.
г. Москва
Общество с ограниченной ответственностью "А7-АГЕНТ" (далее - Агент), в лице Генерального Директора Шора Илана Мироновича, действующего на основании Устава, представляет, а ООО "ТОРМЕДТЕХ",
именуемое в дальнейшем «Принципал», в лице Генерального Директора Трегубова Дениса Аркадьевича, действующего на основании Устава, в рамках договора присоединения, акцепт № 3912 от 30 мая 2025 г.
именуемое в дальнейшем "Договор", принимает настоящий Акт-отчет об исполнении Агентом Поручения Принципала №1 от 17 июня 2025 г. года, именуемое в дальнейшем "Поручение".
1.  Агент исполнил Поручение № 1 от 17 июня 2025 г., а Принципал принял исполнение в следующем объеме:
№
Наименование Получателя платежа 
(и его регистрационные данные), 
реквизиты внешнеторгового 
контракта
Услуга, оказанная Принципалу
Дата услуги, 
оказанной 
Принципалу
Сумма услуги (руб.)
Сумма платежа (в валюте 
платежа)
Вознаграждение Агента, 
включая НДС (руб.)
Курс пересчета
1
CHENGDU
 SANI
 MEDICAL
EQUIPMENT  CO.,  LTD,   Контракт
№
 250529/01
 от
 29.05.2025
г.;Payment
 For
 Proforma
Inv.SN20250602 dd 02.06.2025 
Исполнение  Поручения   № 1  от  17
июня  2025  г.,   проведение  платежа  в
сумме 20 000,00 USD 
23.06.2025 г.
1 570 134,00
20 000,00 USD
60 000,00
курс: 1 USD = 
78,5067 руб.
SWIFT от 23.06.2025 г.
Итого:
1 570 134,00
20 000,00 USD
60 000,00
-
2.  Услуги оказаны с надлежащим качеством, Стороны претензий друг к другу не имеют.
3.  Акт-отчет составлен в 2 (Двух) экземплярах, имеющих равную юридическую силу по одному для каждой из Сторон.
Принципал:
Агент:
Дата подписания: 23 июня 2025 г. 
Дата подписания: 23 июня 2025 г.
/Генеральный Директор ООО "ТОРМЕДТЕХ" Трегубов Денис Аркадьевич
/Генеральный Директор Общество с ограниченной 
ответственностью "А7-АГЕНТ" Шор Илан Миронович  на 
основании Устава               
М.П.
М.П.
ДОКУМЕНТ ПОДПИСАН ЭЛЕКТРОННОЙ ПОДПИСЬЮ
Идентификатор: c5991e23-d74b-43e8-914e-2db84bbc85a4
ОТПРАВЛЕНО
ООО "А7-АГЕНТ", Джалилова Ирина Акифовна
Эл.доверенность №fa5e50e0-d54c-4374-a25c-0a6098bfae9e
02.07.25 16:39 (MSK)
Сертификат 72CB6E00F9B29484495D746C398794B5
Оператор ЭДО ООО "Компания "Тензор"
'''

print("=== Тестирование улучшенных regex-паттернов ===")
print()

# Тестируем извлечение суммы
print("1. Извлечение суммы:")
amount = extract_amount(test_text)
print(f"   Найдена сумма: {amount}")
print()

# Тестируем извлечение компании
print("2. Извлечение названия компании:")
company = extract_company_name(test_text)
print(f"   Найдена компания: '{company}'")
print()

# Тестируем полное извлечение
print("3. Полное извлечение всех реквизитов:")
receipts = extract_all_receipts(test_text)
for key, value in receipts.items():
    print(f"   {key}: {value}")
print()

print("=== Ожидаемые результаты ===")
print("Сумма: 1570134.0 (1 570 134,00 руб)")
print("Компания: А7-АГЕНТ")
print("Дата: 29.05.2025")
print("Номер документа: БП-22102") 